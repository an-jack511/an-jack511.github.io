{{ define "main" }}
  {{- if eq .Kind "taxonomy" }}
  <div class="breadcrumb">
    <a href="{{ "/" | relURL }}{{ .Data.Plural | urlize }}/">{{ .Data.Plural | humanize }}</a> / {{ .Data.Term | humanize }}
  </div>
  {{- else if eq .Kind "section" }}
  <div class="breadcrumb">
    {{ .Title }}
  </div>
  {{- end }}

  <div class="container-article" role="main">
    <main class="main" role="main">
      <section class="list {{ .Kind }}-list">
        {{- $paginator := .Paginator }}
        {{- range $paginator.Pages }}
        <article class="article">
          <a href="{{ .Permalink | relURL }}" class="article-titles">
            <h2 class="article-title">{{ .Title }}</h2>
            {{ with .Params.subtitle }}<h3 class="article-subtitle">{{ . }}</h3>{{ end }}
          </a>
          <ul class="article-meta">
            <li class="article-meta-date"><time>{{ .Date.Format (default "January 2, 2006" $.Site.Params.dateFormat) }}</time></li>
            {{- if .Params.categories }}
            {{- range .Params.categories }}
            <li class="article-meta-categories">
              <a href="{{ "/" | relURL }}categories/{{ . | urlize }}/">
                <i class="fa-solid fa-folder"></i>
                {{ . }}
              </a>&nbsp;
            </li>
            {{- end }}
            {{- end }}
            {{- if .Params.tags }}
            {{- range .Params.tags }}
            <li class="article-meta-tags">
              <a href="{{ "/" | relURL }}tags/{{ . | urlize }}/">
                <i class="fa-solid fa-tag"></i>
                {{ . }}
              </a>&nbsp;
            </li>
            {{- end }}
            {{- end }}
          </ul>
          {{- if .Params.image }}
          <a href="{{ .Permalink | relURL }}"><img src="{{ .Params.image }}" class="article-image" /></a>
          {{- end }}
          <div class="article-content post-summary">
            {{/* 行级预览：不在行中间截断，最多显示前三行。为避免首页摘要中被截断的数学公式（导致 Math 渲染报错），在摘要中移除常见的数学定界符 */}}
            {{ $s := .Summary | plainify }}
            {{ $s = replace $s "$$" "" }}
            {{ $s = replace $s "$" "" }}
            {{ $s = replace $s "\\(" "" }}
            {{ $s = replace $s "\\)" "" }}
            {{ $s = replace $s "\\[" "" }}
            {{ $s = replace $s "\\]" "" }}
            {{ $lines := split $s "\n" }}
            {{ if gt (len $lines) 3 }}
              {{ range first 3 $lines }}
                <p>{{ . }}</p>
              {{ end }}
            {{ else }}
              {{ range $lines }}
                <p>{{ . }}</p>
              {{ end }}
            {{ end }}
          </div>
          <div class="article-readmore"><a href="{{ .Permalink | relURL }}">阅读全文 →</a></div>
          <div class="article-floatclear"></div>
        </article>
        {{- end }}
      </section>
      {{ template "_internal/pagination.html" . }}
    </main>

    <aside class="sidebar" role="complementary">
      {{ partial "sidebar.html" . }}
    </aside>
  </div>

{{ end }}


